sql> CREATE INDEX IF NOT EXISTS osm_ways_idx ON osm_ways USING gist(geom)
[2019-02-12 20:55:36] completed in 47 s 19 ms

sql> CREATE INDEX IF NOT EXISTS osm_nodes_idx ON osm_nodes USING gist(geom)
[2019-02-12 21:05:30] completed in 9 m 39 s 196 ms

sql> UPDATE osm_relations SET geom = r2.geom
     FROM (
       SELECT r3.id as id, st_buildarea(st_makevalid(st_collect(w.geom))) as geom
       FROM (
         SELECT r4.id as id, unnest(r4.member_refs) as m
         FROM osm_relations r4
         WHERE r4.tags -> 'type' = 'multipolygon'
       ) r3 JOIN osm_ways w ON r3.m = w.id
       GROUP BY r3.id
     ) r2
     WHERE osm_relations.id = r2.id
[2019-02-12 21:29:21] 34450 rows affected in 1 m 24 s 864 ms